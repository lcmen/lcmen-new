<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>Today I Learn - Lucas Mendelowski</title>

    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" />
    <meta name="description" content="Short notes of knowledge and interesting discoveries I find during my day-to-day journey." />
    <meta name="turbo-cache-control">

    <meta property="og:title" content="Today I Learn - Lucas Mendelowski" />
    <meta property="og:description" content="Short notes of knowledge and interesting discoveries I find during my day-to-day journey." />
    <meta property="og:image" content="https://www.mendelowski.com/assets/img/social.png" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:url" content="https://www.mendelowski.com" />
    <meta property="og:site_name" content="Lucas Mendelowski" />

    <meta name="twitter:title" content="Today I Learn - Lucas Mendelowski" />
    <meta name="twitter:description" content="Short notes of knowledge and interesting discoveries I find during my day-to-day journey." />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="lcmen_" />
    <meta name="twitter:site" content="lcmen_" />
    <meta name="twitter:image" content="https://www.mendelowski.com/assets/img/social.png" />

    <link rel="canonical" href="https://www.mendelowski.com/.html" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.png" />
    <link crossorigin="crossorigin" href="https://fonts.gstatic.com" rel="preconnect" />
    <link crossorigin="crossorigin" href="https://unpkg.com" rel="preconnect" />
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" />
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" /></noscript>
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css">
    <link rel="stylesheet" href="/assets/css/main.css" media="screen" data-turbo-track="reload">
    <script src="/assets/js/main.js" data-turbo-track="reload"></script>
    <script src="https://unpkg.com/@hotwired/turbo" defer></script>
  </head>
  <body>
    <div id="main">
      <header id="header" class="container mx-auto" data-turbo-permanent>
  <div class="flex items-center justify-between py-6 lg:py-10">
    <a href="/" class="flex items-center" aria-label="Homepage">
      <span class="mr-2">
        <img src="/assets/img/logo.svg" width="44" height="36" alt="logo" class="mr-2"  />
      </span>
    </a>
    <div class="flex items-center lg:hidden">
      <button id="menu" class="group z-50" aria-label="Mobile menu">
        <svg
          width="24"
          height="15"
          xmlns="http://www.w3.org/2000/svg"
          class="relative z-50 fill-current text-primary transition-transform group-[.active]:fill-white group-[.active]:rotate-90"
        >
          <g fill-rule="evenodd">
            <rect width="24" height="3" />
            <rect y="6" width="24" height="3" />
            <rect y="12" width="24" height="3" />
          </g>
        </svg>
      </button>
      <nav class="pointer-events-none fixed inset-0 z-30 flex bg-black bg-opacity-80 opacity-0 transition-opacity lg:hidden duration-300">
        <div class="ml-auto w-2/3 bg-green p-4 md:w-1/3">
          <ul class="mt-8 flex flex-col">
            <li>
              <a
                href="/"
                class="mb-3 block px-2 font-body text-lg font-medium text-white"
                aria-label="Intro"
              >Intro</a>
            </li>

            <li>
              <a
                href="/blog/"
                class="mb-3 block px-2 font-body text-lg font-medium text-white"
                aria-label="Blog"
              >Blog</a>
            </li>

            <li>
              <a
                href="/til/"
                class="mb-3 block px-2 font-body text-lg font-medium text-white"
                aria-label="Today I Learned"
              >Til</a>
            </li>

            <li>
              <a
                href="/uses/"
                class="mb-3 block px-2 font-body text-lg font-medium text-white"
                aria-label="Uses"
              >Uses</a>
            </li>

            <li>
              <a
                href="/contact/"
                class="mb-3 block px-2 font-body text-lg font-medium text-white"
                aria-label="Contact"
              >Contact</a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
    <div class="hidden lg:block">
      <ul class="flex items-center">
        <li class="group relative mr-6 mb-1">
          <div class="absolute left-0 bottom-0 z-20 h-0 w-full opacity-75 transition-all group-hover:h-2 group-hover:bg-yellow">
          </div>
          <a
            href="/"
            class="relative z-30 block px-2 font-body text-lg font-medium text-primary transition-colors group-hover:text-green"
            aria-label="Intro"
          >Intro</a>
        </li>

        <li class="group relative mr-6 mb-1">
          <div class="absolute left-0 bottom-0 z-20 h-0 w-full opacity-75 transition-all group-hover:h-2 group-hover:bg-yellow">
          </div>
          <a
            href="/blog/"
            class="relative z-30 block px-2 font-body text-lg font-medium text-primary transition-colors group-hover:text-green"
            aria-label="Blog"
          >Blog</a>
        </li>

        <li class="group relative mr-6 mb-1">
          <div class="absolute left-0 bottom-0 z-20 h-0 w-full opacity-75 transition-all group-hover:h-2 group-hover:bg-yellow">
          </div>
          <a
            href="/til/"
            class="relative z-30 block px-2 font-body text-lg font-medium text-primary transition-colors group-hover:text-green"
            aria-label="Today I Learned"
          >Til</a>
        </li>

        <li class="group relative mr-6 mb-1">
          <div class="absolute left-0 bottom-0 z-20 h-0 w-full opacity-75 transition-all group-hover:h-2 group-hover:bg-yellow">
          </div>
          <a
            href="/uses/"
            class="relative z-30 block px-2 font-body text-lg font-medium text-primary transition-colors group-hover:text-green"
            aria-label="Uses"
          >Uses</a>
        </li>

        <li class="group relative mr-6 mb-1">
          <div class="absolute left-0 bottom-0 z-20 h-0 w-full opacity-75 transition-all group-hover:h-2 group-hover:bg-yellow">
          </div>
          <a
            href="/contact/"
            class="relative z-30 block px-2 font-body text-lg font-medium text-primary transition-colors group-hover:text-green"
            aria-label="Contact"
          >Contact</a>
        </li>
      </ul>
    </div>
  </div>
</header>


      <div>
        <div class="container mx-auto">
          <div class="py-16 lg:py-20">
  <div>
    <img srcset="/assets/img/icon-til_2x.png 2x" src="/assets/img/icon-til.png" alt="icon envelope" width="40" height="36" />
  </div>

  <h1 class="pt-5 font-body text-4xl font-semibold text-primary md:text-5xl lg:text-6xl">
    Today I Learned
  </h1>

  <div class="pt-3 sm:w-3/4">
    <p class="font-body text-xl font-light text-primary">
      Short notes from all the things I learned across a variety of languages and technologies.
    </p>
  </div>

  <div class="pt-8 lg:pt-12">
    
      
      <article class="">
  <p class="mb-4">
    
      <span class="inline-block rounded-full bg-secondary px-2 py-1 font-body text-sm text-white">
  #ruby
</span>

    
  </p>
  <h2 class="block font-body text-3xl font-semibold leading-tight text-primary transition-colors">
    Show Rake task details
  </h2>
  <div class="flex items-center gap-2 py-4 font-body text-grey">
    <p class="font-light">
      November 28, 2023
    </p>
  </div>
  <content class="prose prose max-w-none">
    <p>Rake, a Make-like program implemented in Ruby has an option to show details of a specific task.</p>

<p>Let’s say we have a simple <code class="language-plaintext highlighter-rouge">Rakefile</code> with a following content:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">namespace</span> <span class="ss">:foo</span> <span class="k">do</span>
  <span class="n">desc</span> <span class="s2">"Simple foo:bar task that accepts 2 arguments to demonstrate rake -D option"</span>
  <span class="n">task</span> <span class="ss">:bar</span><span class="p">,</span> <span class="p">[</span><span class="ss">:arg1</span><span class="p">,</span> <span class="ss">:arg2</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="ss">:environment</span> <span class="k">do</span> <span class="o">|</span><span class="n">_</span><span class="p">,</span> <span class="n">args</span><span class="o">|</span>
    <span class="nb">puts</span> <span class="s2">"foo:bar"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Executing <code class="language-plaintext highlighter-rouge">rake -D foo:bar</code> will show task description (including its arguments) in a user-friendly format:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/Repos <span class="o">&gt;</span> rake <span class="nt">-D</span> foo:bar
rake foo:bar[arg1,arg2]
    Simple foo:bar task that accepts 2 arguments to demonstrate rake <span class="nt">-D</span> option
</code></pre></div></div>

  </content>
</article >

    
      
      <article class="border-t border-grey-lighter mt-8 pt-8">
  <p class="mb-4">
    
      <span class="inline-block rounded-full bg-secondary px-2 py-1 font-body text-sm text-white">
  #ruby
</span>

    
      <span class="inline-block rounded-full bg-secondary px-2 py-1 font-body text-sm text-white">
  #rails
</span>

    
  </p>
  <h2 class="block font-body text-3xl font-semibold leading-tight text-primary transition-colors">
    Fingerprinted URL to Ruby on Rails asset files
  </h2>
  <div class="flex items-center gap-2 py-4 font-body text-grey">
    <p class="font-light">
      October 09, 2023
    </p>
  </div>
  <content class="prose prose max-w-none">
    <p>To get relative URL to application’s assets with their fingerprints, <code class="language-plaintext highlighter-rouge">ActionController::Base.helpers#asset_url</code> method can be used.
It accepts a file name, and prints the relative path to the file, e.g.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):002:0&gt; ActionController::Base.helpers.asset_path("application.js")
=&gt; "/assets/application-8bf8a8aca6320619e6e4a215ae3f613d9cc3aa269397aa3fc93b821b1c56319c.js"
</code></pre></div></div>

<p>If the absolute URL is needed, then <code class="language-plaintext highlighter-rouge">host</code> option must be provided, e.g.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):004:0&gt; ActionController::Base.helpers.asset_path("application.js", host: "http://localhost:3000")
=&gt; "http://localhost:3000/assets/application-8bf8a8aca6320619e6e4a215ae3f613d9cc3aa269397aa3fc93b821b1c56319c.js"
</code></pre></div></div>

<p>Since, providing <code class="language-plaintext highlighter-rouge">host</code> manually can be cumbersome, it can be automated with a simple helper:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">asset_host</span>
  <span class="vi">@host</span> <span class="o">||=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">asset_host</span> <span class="o">||</span> <span class="n">default_host</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">default_host</span>
  <span class="n">opts</span> <span class="o">=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">default_url_options</span><span class="p">.</span><span class="nf">dup</span><span class="p">.</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">options</span><span class="o">|</span>
    <span class="n">options</span><span class="p">[</span><span class="ss">:scheme</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="ss">:protocol</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="no">URI</span><span class="o">::</span><span class="no">Generic</span><span class="p">.</span><span class="nf">build</span><span class="p">(</span><span class="n">opts</span><span class="p">).</span><span class="nf">to_s</span>
<span class="k">end</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Rails.configuration.asset_host</code> is usually set if public assets are hosted on some CDN server. Otherwise the method falls back
to application’s host configured in <code class="language-plaintext highlighter-rouge">default_url_options</code>.</p>

  </content>
</article >

    
      
      <article class="border-t border-grey-lighter mt-8 pt-8">
  <p class="mb-4">
    
      <span class="inline-block rounded-full bg-secondary px-2 py-1 font-body text-sm text-white">
  #ruby
</span>

    
  </p>
  <h2 class="block font-body text-3xl font-semibold leading-tight text-primary transition-colors">
    Deprecating methods with ActiveSupport
  </h2>
  <div class="flex items-center gap-2 py-4 font-body text-grey">
    <p class="font-light">
      September 13, 2020
    </p>
  </div>
  <content class="prose prose max-w-none">
    <p>When working on the code (especially in publicly available libraries) there are situations, where some methods are planned for phase-out. In those cases, <code class="language-plaintext highlighter-rouge">ActiveSupport#deprecate</code> method might come handy:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span>
  <span class="k">def</span> <span class="nf">full_name</span>
    <span class="s2">"</span><span class="si">#{</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">last_name</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">name</span>
    <span class="n">full_name</span>
  <span class="k">end</span>

  <span class="n">deprecate</span> <span class="ss">:name</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now whenever <code class="language-plaintext highlighter-rouge">User.name</code> is called, a deprecation warning will be displayed:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):011:0&gt; user.name
DEPRECATION WARNING: name is deprecated and will be removed from Rails 7.2 (called from irb_binding at (irb):11)
=&gt; "Jon Snow"
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ActiveSupport#deprecate</code> allows to specify a new method’s name that should be used instead:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span>
  <span class="o">...</span>

  <span class="n">deprecate</span> <span class="ss">name: :full_name</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):014:0&gt; user.name
DEPRECATION WARNING: name is deprecated and will be removed from Rails 7.2 (use full_name instead) (called from irb_binding at (irb):14)
=&gt; "Jon Snow"
</code></pre></div></div>

<p>It’s also possible to customize a message:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span>
  <span class="o">...</span>

  <span class="n">deprecate</span> <span class="ss">name: </span><span class="s1">'try User#full_name instead'</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):017:0&gt; user.name
DEPRECATION WARNING: name is deprecated and will be removed from Rails 7.2 (try User#full_name instead) (called from irb_binding at (irb):17)
=&gt; "Jon Snow"
</code></pre></div></div>

<p>Release name and its version can be adjusted (via custom deprecator) as well:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span>
  <span class="o">...</span>

  <span class="n">next_release_deprecator</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Deprecation</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'next-release'</span><span class="p">,</span> <span class="s1">'MyGem'</span><span class="p">)</span>

  <span class="n">deprecate</span> <span class="ss">name: </span><span class="s1">'try User#full_name instead'</span><span class="p">,</span> <span class="ss">deprecator: </span><span class="n">next_release_deprecator</span>
  <span class="c1"># or use deprecator directly</span>
  <span class="c1"># next_release_deprecator.deprecate_methods(self, name: :full_name)</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):020:0&gt; user.name
DEPRECATION WARNING: name is deprecated and will be removed from MyGem next-release (try User#full_name instead) (called from irb_binding at (irb):24)
=&gt; "Jon Snow"
</code></pre></div></div>

  </content>
</article >

    
      
      <article class="border-t border-grey-lighter mt-8 pt-8">
  <p class="mb-4">
    
      <span class="inline-block rounded-full bg-secondary px-2 py-1 font-body text-sm text-white">
  #ruby
</span>

    
  </p>
  <h2 class="block font-body text-3xl font-semibold leading-tight text-primary transition-colors">
    Padding numbers with zeros in Ruby
  </h2>
  <div class="flex items-center gap-2 py-4 font-body text-grey">
    <p class="font-light">
      February 29, 2020
    </p>
  </div>
  <content class="prose prose max-w-none">
    <p><a href="https://ruby-doc.org/3.2.2/String.html#method-i-25">String#%</a> method allows to specify format to apply to its argument. It can be used to pad numbers with zeros.</p>

<h3 id="leading-zeros">Leading zeros</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; "%03d" % 2
=&gt; "002"
</code></pre></div></div>

<h3 id="trailing-zeros">Trailing zeros</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; "%.2f" % 2
=&gt; "2.00"
</code></pre></div></div>

  </content>
</article >

    
      
      <article class="border-t border-grey-lighter mt-8 pt-8">
  <p class="mb-4">
    
      <span class="inline-block rounded-full bg-secondary px-2 py-1 font-body text-sm text-white">
  #ruby
</span>

    
      <span class="inline-block rounded-full bg-secondary px-2 py-1 font-body text-sm text-white">
  #rails
</span>

    
  </p>
  <h2 class="block font-body text-3xl font-semibold leading-tight text-primary transition-colors">
    HSTS with Rails
  </h2>
  <div class="flex items-center gap-2 py-4 font-body text-grey">
    <p class="font-light">
      August 26, 2019
    </p>
  </div>
  <content class="prose prose max-w-none">
    <h1 id="hsts-with-rails">HSTS with Rails</h1>

<p><strong>TL;DR</strong> HSTS tells browsers to always make requests over HTTPS to HSTS sites.</p>

<p>HSTS (HTTP Strict Transport Security) is a mechanism for preventing man-in-the-middle attack known as SSL Stripping. Such attack relies on hijacking browser connection to use <code class="language-plaintext highlighter-rouge">http</code> instead of <code class="language-plaintext highlighter-rouge">https</code> for communication with the server. Using <code class="language-plaintext highlighter-rouge">Strict-Transport-Security</code> header we can declare that browser should communicate with <code class="language-plaintext highlighter-rouge">https</code> only and specify a period of time for such behavior.</p>

<p>Example of attack from <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">MDN docs</a>:</p>

<blockquote>
  <p>You log into a free WiFi access point at an airport and start surfing the web, visiting your online banking service to check your balance and pay a couple of bills. Unfortunately, the access point you’re using is actually a hacker’s laptop, and they’re intercepting your original HTTP request and redirecting you to a clone of your bank’s site instead of the real thing. Now your private data is exposed to the hacker.</p>

  <p>Strict Transport Security resolves this problem; as long as you’ve accessed your bank’s web site once using HTTPS, and the bank’s web site uses Strict Transport Security, your browser will know to automatically use only HTTPS, which prevents hackers from performing this sort of man-in-the-middle attack.</p>
</blockquote>

<p>HSTS can be enabled by switching <code class="language-plaintext highlighter-rouge">force_ssl</code> option in the application’s config:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/environment/production.rb</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span>
  <span class="o">...</span>

  <span class="n">config</span><span class="p">.</span><span class="nf">force_ssl</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="o">...</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Setting <code class="language-plaintext highlighter-rouge">force_ssl</code> to <code class="language-plaintext highlighter-rouge">true</code>, inserts
<a href="https://api.rubyonrails.org/classes/ActionDispatch/SSL.html">ActionDispatch::SSL</a> middleware which is responsible for 3 things:</p>

<ol>
  <li>Redirecting <code class="language-plaintext highlighter-rouge">http</code> requests to <code class="language-plaintext highlighter-rouge">https</code></li>
  <li>Adding <code class="language-plaintext highlighter-rouge">HSTS</code> header to the response</li>
  <li>Set <code class="language-plaintext highlighter-rouge">secure</code> flag on cookies to send them through <code class="language-plaintext highlighter-rouge">https</code> only</li>
</ol>

  </content>
</article >

    
  </div>

  
  <div class="flex pt-8 lg:pt-16 gap-3">
    

    
      
        
          <span class="cursor-pointer border-2 border-secondary px-3 py-1 font-body font-medium text-secondary">
            1
          </span>
        
      
        
          <a
            href="/til/2/"
            class="cursor-pointer border-2 border-primary px-3 py-1 font-body font-medium text-primary transition-colors hover:border-secondary hover:text-secondary"
            aria-label="Page 2"
          >2</a>
        
      
    

    
      <a
        href="/til/2/"
        class="group flex cursor-pointer items-center border-2 border-primary px-3 py-1 font-body font-medium text-primary transition-colors hover:border-secondary hover:text-secondary"
        aria-label="Next page"
      >
        Next
        <i class="bx bx-right-arrow-alt ml-1 text-primary transition-colors group-hover:text-secondary"></i>
      </a>
    
  </div>


</div>

        </div>
      </div>

      <footer id="footer" class="container mx-auto">
  <div class="flex flex-col items-center justify-between border-t border-grey-lighter py-10 sm:flex-row sm:py-12">
    <p class="font-body font-light text-primary">
      &copy; 2023 Lucas Mendelowski
    </p>
    <div class="flex items-center pt-5 gap-5 sm:pt-0">
      
        <a href="https://github.com/lcmen" target="_blank" aria-label="github">
          <i class="text-4xl text-primary hover:text-secondary transition-colors bx bxl-github"></i>
        </a>
      
        <a href="https://www.linkedin.com/in/lucasmendelowski/" target="_blank" aria-label="linkedin">
          <i class="text-4xl text-primary hover:text-secondary transition-colors bx bxl-linkedin"></i>
        </a>
      
        <a href="https://twitter.com/lcmen_" target="_blank" aria-label="twitter">
          <i class="text-4xl text-primary hover:text-secondary transition-colors bx bxl-twitter"></i>
        </a>
      
    </div>
  </div>
</footer>

    </div>
  </body>
</html>
